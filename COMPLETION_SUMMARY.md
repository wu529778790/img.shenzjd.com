# é¡¹ç›®å®Œæˆæ€»ç»“ - Nuxt 4 + GitHub OAuth å›¾åºŠåº”ç”¨

## âœ… é¡¹ç›®çŠ¶æ€: å·²å®Œæˆ

**å®Œæˆæ—¥æœŸ**: 2026-01-07
**å½“å‰åˆ†æ”¯**: `nuxt4-refactor`
**æ„å»ºçŠ¶æ€**: âœ… æˆåŠŸ (2.49 MB, 615 kB gzip)

---

## ğŸ“‹ å·²å®Œæˆçš„ä»»åŠ¡

### 1. âœ… é¡¹ç›®é‡æ„ (Phase 1-8)
ä» Vue 3 å®Œå…¨é‡æ„ä¸º Nuxt 4 + GitHub OAuth æ¶æ„

### 2. âœ… GitHub OAuth è®¤è¯
- OAuth æµç¨‹å®ç° (4ä¸ªAPIç«¯ç‚¹)
- JWT Token ç®¡ç†
- HTTP-only Cookie è®¤è¯
- æ— éœ€æ‰‹åŠ¨ Token

### 3. âœ… å®Œå…¨å¯é…ç½®å­˜å‚¨
æ”¯æŒç”¨æˆ·é…ç½®:
- **ä»“åº“**: ä»»æ„ç”¨æˆ·/ä»“åº“
- **åˆ†æ”¯**: ä»»æ„åˆ†æ”¯
- **ç›®å½•**: è‡ªåŠ¨/è‡ªå®šä¹‰/æ ¹ç›®å½•æ¨¡å¼
- **å‘½å**: å“ˆå¸Œ/æ—¶é—´æˆ³/åŸå/è‡ªå®šä¹‰
- **å›¾ç‰‡å¤„ç†**: å‹ç¼©ã€æ°´å°ã€å°ºå¯¸é™åˆ¶
- **é“¾æ¥æ ¼å¼**: Markdown/HTML/BBCode/çº¯æ–‡æœ¬
- **CDN**: GitHub/jsDelivr/è‡ªå®šä¹‰åŸŸå

### 4. âœ… 7ä¸ªé¡µé¢ç»„ä»¶
1. `index.vue` - é¦–é¡µ/æ¬¢è¿é¡µ
2. `login.vue` - GitHub ç™»å½•
3. `config.vue` - ä»“åº“é…ç½®
4. `upload.vue` - å›¾ç‰‡ä¸Šä¼ 
5. `manage.vue` - æ–‡ä»¶ç®¡ç†
6. `settings.vue` - åº”ç”¨è®¾ç½®
7. `tools.vue` - å·¥å…·ç®±

### 5. âœ… 16ä¸ªAPIç«¯ç‚¹
**è®¤è¯ (4ä¸ª)**
- `GET /api/auth/github` - å‘èµ· OAuth
- `GET /api/auth/callback` - OAuth å›è°ƒ
- `POST /api/auth/logout` - ç™»å‡º
- `GET /api/auth/verify` - éªŒè¯ä»¤ç‰Œ

**ç”¨æˆ·é…ç½® (2ä¸ª)**
- `GET /api/user/config` - è·å–é…ç½®
- `PUT /api/user/config` - ä¿å­˜é…ç½®

**ä»“åº“ç®¡ç† (5ä¸ª)**
- `GET /api/repo/list` - åˆ—å‡ºä»“åº“
- `POST /api/repo/create` - åˆ›å»ºä»“åº“
- `POST /api/repo/init` - åˆå§‹åŒ–ä»“åº“
- `GET /api/repo/branches` - åˆ—å‡ºåˆ†æ”¯
- `GET /api/repo/contents` - åˆ—å‡ºç›®å½•å†…å®¹

**ä¸Šä¼ åŠŸèƒ½ (2ä¸ª)**
- `PUT /api/upload/image` - å•å›¾ä¸Šä¼ 
- `POST /api/upload/batch` - æ‰¹é‡ä¸Šä¼ 

**æ–‡ä»¶ç®¡ç† (3ä¸ª)**
- `GET /api/management/list` - åˆ—å‡ºæ–‡ä»¶
- `DELETE /api/management/delete` - åˆ é™¤æ–‡ä»¶
- `PATCH /api/management/rename` - é‡å‘½åæ–‡ä»¶

### 6. âœ… 5ä¸ªPiniaçŠ¶æ€ç®¡ç†å•†åº—
- `auth.ts` - è®¤è¯çŠ¶æ€
- `config.ts` - é…ç½®ç®¡ç†
- `upload.ts` - ä¸Šä¼ ç®¡ç†
- `management.ts` - æ–‡ä»¶ç®¡ç†
- `toast.ts` - é€šçŸ¥ç³»ç»Ÿ

### 7. âœ… å›½é™…åŒ–æ”¯æŒ
3ç§è¯­è¨€æ–‡ä»¶:
- `zh-CN.json` - ç®€ä½“ä¸­æ–‡
- `zh-TW.json` - ç¹ä½“ä¸­æ–‡
- `en.json` - è‹±æ–‡

### 8. âœ… æ·±è‰²æ¨¡å¼
å®Œæ•´æ”¯æŒ Light/Dark/Auto ä¸»é¢˜åˆ‡æ¢

### 9. âœ… å·¥å…·ç®± (5ä¸ªå·¥å…·)
- Base64 ç¼–è§£ç 
- å›¾ç‰‡å‹ç¼©
- æ°´å°æ·»åŠ 
- é“¾æ¥è½¬æ¢
- æ‰¹é‡é‡å‘½å

### 10. âœ… æ–‡æ¡£æ•´åˆ
æ‰€æœ‰æ–‡æ¡£åˆå¹¶åˆ° `README.md` (631è¡Œ)

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

| ç±»åˆ« | æ•°é‡ |
|------|------|
| é¡µé¢ç»„ä»¶ | 7 ä¸ª |
| API ç«¯ç‚¹ | 16 ä¸ª |
| Pinia å•†åº— | 5 ä¸ª |
| å·¥å…·å‡½æ•° | 2 ä¸ª |
| ä¸­é—´ä»¶ | 1 ä¸ª |
| è¯­è¨€æ–‡ä»¶ | 3 ç§ |
| æ„å»ºå¤§å° | 2.49 MB (615 kB gzip) |

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Nuxt | 4.2.2 | æ¡†æ¶ |
| TypeScript | 5.7.2 | ç±»å‹å®‰å…¨ |
| Pinia | 2.2.6 | çŠ¶æ€ç®¡ç† |
| Element Plus | 2.9.0 | UI ç»„ä»¶ |
| TailwindCSS | 3.4.0 | æ ·å¼ |
| @nuxtjs/i18n | 9.1.1 | å¤šè¯­è¨€ |
| jose | 5.9.6 | JWT å¤„ç† |
| date-fns | 3.6.0 | æ—¥æœŸæ ¼å¼åŒ– |
| jszip | 3.10.1 | æ‰¹é‡å‹ç¼© |

---

## ğŸ” å®‰å…¨ç‰¹æ€§

1. **Client Secret**: ä»…åœ¨æœåŠ¡ç«¯ä½¿ç”¨ï¼Œæ°¸ä¸æš´éœ²
2. **JWT Token**: 7å¤©è¿‡æœŸæ—¶é—´
3. **Cookie-based Auth**: HTTP-only cookies
4. **Repository Isolation**: æ¯ä¸ªç”¨æˆ·æ•°æ®åœ¨è‡ªå·±çš„ä»“åº“
5. **æƒé™éªŒè¯**: æ‰€æœ‰ API å¿…é¡»éªŒè¯ JWT

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
img.shenzjd.com/
â”œâ”€â”€ app.vue                    # æ ¹ç»„ä»¶
â”œâ”€â”€ nuxt.config.ts             # Nuxt é…ç½®
â”œâ”€â”€ package.json               # ä¾èµ–
â”œâ”€â”€ tailwind.config.ts         # Tailwind é…ç½®
â”œâ”€â”€ tsconfig.json              # TypeScript é…ç½®
â”œâ”€â”€ README.md                  # å®Œæ•´æ–‡æ¡£ (631è¡Œ)
â”‚
â”œâ”€â”€ pages/                     # 7 ä¸ªé¡µé¢
â”‚   â”œâ”€â”€ index.vue
â”‚   â”œâ”€â”€ login.vue
â”‚   â”œâ”€â”€ config.vue
â”‚   â”œâ”€â”€ upload.vue
â”‚   â”œâ”€â”€ manage.vue
â”‚   â”œâ”€â”€ settings.vue
â”‚   â””â”€â”€ tools.vue
â”‚
â”œâ”€â”€ server/                    # æœåŠ¡ç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/                   # 16 ä¸ª API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth/              # è®¤è¯ (4ä¸ª)
â”‚   â”‚   â”œâ”€â”€ user/              # ç”¨æˆ·é…ç½® (2ä¸ª)
â”‚   â”‚   â”œâ”€â”€ repo/              # ä»“åº“ç®¡ç† (5ä¸ª)
â”‚   â”‚   â”œâ”€â”€ upload/            # ä¸Šä¼  (2ä¸ª)
â”‚   â”‚   â””â”€â”€ management/        # ç®¡ç† (3ä¸ª)
â”‚   â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ github.ts
â”‚   â”‚   â””â”€â”€ jwt.ts
â”‚   â””â”€â”€ middleware/            # ä¸­é—´ä»¶
â”‚       â””â”€â”€ auth.ts
â”‚
â”œâ”€â”€ stores/                    # 5 ä¸ª Pinia å•†åº—
â”‚   â”œâ”€â”€ auth.ts
â”‚   â”œâ”€â”€ config.ts
â”‚   â”œâ”€â”€ upload.ts
â”‚   â”œâ”€â”€ management.ts
â”‚   â””â”€â”€ toast.ts
â”‚
â”œâ”€â”€ locales/                   # 3 ç§è¯­è¨€
â”‚   â”œâ”€â”€ zh-CN.json
â”‚   â”œâ”€â”€ zh-TW.json
â”‚   â””â”€â”€ en.json
â”‚
â””â”€â”€ components/                # ç»„ä»¶
    â””â”€â”€ Navigation.vue         # å¯¼èˆªèœå•
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½® GitHub OAuth
è®¿é—® [GitHub Developer Settings](https://github.com/settings/developers) åˆ›å»º OAuth Appï¼Œè®¾ç½®å›è°ƒ URL ä¸º:
```
http://localhost:3000/api/auth/callback
```

### 2. ç¯å¢ƒé…ç½®
```bash
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ GITHUB_CLIENT_ID, GITHUB_CLIENT_SECRET, JWT_SECRET
```

### 3. å®‰è£…å¹¶è¿è¡Œ
```bash
pnpm install
pnpm dev
# è®¿é—® http://localhost:3000
```

### 4. æ„å»ºç”Ÿäº§ç‰ˆ
```bash
pnpm build
pnpm preview
```

---

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

1. âœ… **é›¶é…ç½®ç™»å½•**: ç”¨æˆ·åªéœ€ç‚¹å‡»æˆæƒï¼Œæ— éœ€æ‰‹åŠ¨ Token
2. âœ… **æ•°æ®è‡ªä¸»**: å­˜å‚¨åœ¨ç”¨æˆ·è‡ªå·±çš„ GitHub ä»“åº“
3. âœ… **å®Œå…¨å¯é…**: ä»“åº“ã€åˆ†æ”¯ã€ç›®å½•ã€å‘½åã€æ ¼å¼å‡å¯é…ç½®
4. âœ… **ç°ä»£åŒ–æ¶æ„**: Nuxt 4 + TypeScript + Pinia
5. âœ… **å›½é™…åŒ–**: 3ç§è¯­è¨€ + æ·±è‰²æ¨¡å¼
6. âœ… **æ˜“äºæ‰©å±•**: æ¸…æ™°çš„æ¨¡å—åŒ–ç»“æ„

---

## ğŸ“ Git ä¿¡æ¯

**åˆ†æ”¯**: `nuxt4-refactor`
**æœ€æ–°æäº¤**: `b80761e` - docs: åˆå¹¶æ‰€æœ‰æ–‡æ¡£åˆ° README.md
**å‰ä¸€æäº¤**: `aa535a8` - refactor: é‡æ„ä¸º Nuxt 4 + GitHub OAuth æ¶æ„

---

## âœ¨ é¡¹ç›®äº®ç‚¹

- ğŸ” **GitHub OAuth** - å®‰å…¨ä¾¿æ·çš„ç™»å½•æ–¹å¼
- ğŸ“ **ä¸ªäººä»“åº“å­˜å‚¨** - æ•°æ®å®Œå…¨è‡ªä¸»å¯æ§
- âš™ï¸ **å®Œå…¨å¯é…ç½®** - æ»¡è¶³å„ç§ä½¿ç”¨åœºæ™¯
- ğŸ“¤ **æ‰¹é‡ä¸Šä¼ ** - æ‹–æ‹½ã€å¤šæ–‡ä»¶æ”¯æŒ
- ğŸ¨ **å›¾ç‰‡å¤„ç†** - å‹ç¼©ã€åŠ æ°´å°ç­‰å·¥å…·
- ğŸ“‹ **æ–‡ä»¶ç®¡ç†** - æŸ¥çœ‹ã€é‡å‘½åã€åˆ é™¤
- ğŸŒ **å¤šè¯­è¨€** - ç®€ä¸­ã€ç¹ä¸­ã€English
- ğŸ¨ **æ·±è‰²æ¨¡å¼** - å®Œæ•´ä¸»é¢˜æ”¯æŒ
- ğŸ”§ **å·¥å…·ç®±** - Base64ã€URL ç”Ÿæˆã€æ‰¹é‡é‡å‘½åç­‰

---

**é¡¹ç›®å·²å®Œå…¨å®Œæˆï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ï¼** ğŸ‰
